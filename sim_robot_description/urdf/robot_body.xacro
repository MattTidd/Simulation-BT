<?xml version = '1.0'?>
<robot xmlns:xacro = 'http://www.ros.org/wiki/xacro'>

    <!-- PROPERTIES -->
    <xacro:property name = 'a' value = '4'/>    <!--scalar used for inertia -->
    <xacro:property name = 'd' value = '0.5'/>  <!--scalar used for damping -->

    <material name = 'black'>
        <color rgba = '0.1 0.1 0.1 1'/>
    </material>

    <material name = 'green'>
        <color rgba = '0 0.7 0 1'/>
    </material>

    <material name = 'gray'>
        <color rgba = '0.83 0.83 0.83 1'/>
    </material>

    <!--            BASE LINK & JOINTS           -->

    <!-- base link -->
    <link name = 'base_link'>
    </link>

    <!-- imu link -->
    <link name = 'imu_link'>
    </link>

    <!-- chassis link -->
    <link name = 'chassis_link'>
        <visual>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/chassis.STL'/>
            </geometry>
            <material name = 'green'/>
        </visual>

        <collision>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/chassis.STL'/>
            </geometry>
        </collision>

        <inertial>
            <mass value = '2.415'/> <!--corrected mass value measured without wheels-->
            <inertia
                    ixx = '${a*0.00196277727666921}'
                    ixy = '${a*2.50447049446755E-07}'
                    ixz = '${a*0.000140534767811098}'
                    iyy = '${a*0.00457256033711368}'
                    iyz = '${a*2.68618064993882E-07}'
                    izz = '${a*0.00493927269870476}'/>
        </inertial>
    </link>

    <!-- chassis to base link joint -->
    <joint name = 'base_joint' type = 'fixed'>
        <parent link = 'base_link'/>
        <child link = 'chassis_link'/>
        <origin xyz = '0.0 0.0 0.07115' rpy = '0 0 0'/>
    </joint>

    <!-- imu to chassis joint -->
    <joint name = 'base_imu' type = 'fixed'>
        <parent link = 'chassis_link'/>
        <child link = 'imu_link'/>
        <origin xyz = '-0.06 0.01 0.01' rpy = '0 3.1415 1.5707'/>
    </joint>

    <!--            WHEEL LINKS & JOINTS             -->

    <!-- front right wheel link -->
    <link name = 'front_right_wheel_link'>
        <visual>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/front_right_wheel.STL'/>
            </geometry>
            <material name = 'black'/>
        </visual>

        <collision>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/front_right_wheel.STL'/>
            </geometry>
        </collision>

        <inertial>
            <mass value = '0.051532'/>
            <inertia ixx = '${a*1.4595E-05}' 
                     ixy = '${a*-4.3975E-10}' 
                     ixz = '${a*4.415E-10}'
                     iyy = '${a*1.4594E-05}' 
                     iyz = '${a*-1.7476E-09}' 
                     izz = '${a*2.4264E-05}'/>
        </inertial>
    </link>

    <!-- front right wheel to chassis joint -->
    <joint name = 'front_right_joint' type = 'continuous'>
        <origin xyz = '0.08 -0.0845 -0.0389' rpy = '-1.5703 0 3.14159'/>
        <parent link = 'chassis_link'/>
        <child link = 'front_right_wheel_link'/>
        <axis xyz = '0 0 -1' rpy = '0 0 0'/>
        <dynamics damping = '${d}'/>
    </joint>

    <!-- front left wheel link -->
    <link name = 'front_left_wheel_link'>
        <visual>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/front_left_wheel.STL'/>
            </geometry>
            <material name = 'black'/>
        </visual>

        <collision>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/front_left_wheel.STL'/>
            </geometry>
        </collision>

        <inertial>
            <mass value = '0.051543'/>
            <inertia ixx = '${a*1.4597E-05}' 
                     ixy = '${a*-4.7945E-10}' 
                     ixz = '${a*-2.4786E-10}'
                     iyy = '${a*1.4598E-05}' 
                     iyz = '${a*1.7972E-09}' 
                     izz = '${a*2.4267E-05}'/>
        </inertial>
    </link>

    <!-- front left wheel to chassis joint -->
    <joint name = 'front_left_joint' type = 'continuous'>
        <origin xyz = '0.08 0.084492 -0.0389' rpy = '1.5703 0 0'/>
        <parent link = 'chassis_link'/>
        <child link = 'front_left_wheel_link'/>
        <axis xyz = '0 0 -1' rpy = '0 0 0'/>
        <dynamics damping = '${d}'/>
    </joint>

    <!-- back right wheel link -->
    <link name = 'back_right_wheel_link'>
        <visual>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/back_right_wheel.STL'/>
            </geometry>
            <material name = 'black'/>
        </visual>

        <collision>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/back_right_wheel.STL'/>
            </geometry>
        </collision>

        <inertial>
            <mass value = '0.051540174053366'/>
            <inertia ixx = '${a*1.45974152250002E-05}' 
                     ixy = '${a*1.94850559178397E-10}' 
                     ixz = '${a*-1.61846387282284E-09}'
                     iyy = '${a*1.4596501955693E-05}' 
                     iyz = '${a*-6.27904057423818E-10}' 
                     izz = '${a*2.42663091380451E-05}'/>
        </inertial>
    </link>

    <!-- back right wheel to chassis joint -->
    <joint name = 'back_right_joint' type = 'continuous'>
        <origin xyz = '-0.08 -0.0845 -0.03946' rpy = '-1.57 0 3.14159'/>
        <parent link = 'chassis_link'/>
        <child link = 'back_right_wheel_link'/>
        <axis xyz = '0 0 -1' rpy = '0 0 0'/>
        <dynamics damping = '${d}'/>
    </joint>

    <!-- back left wheel link -->
    <link name = 'back_left_wheel_link'>
        <visual>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/back_left_wheel.STL'/>
            </geometry>
            <material name = 'black'/>
        </visual>

        <collision>
            <origin xyz = '0 0 0' rpy = '0 0 0'/>
            <geometry>
                <mesh filename = 'file://$(find sim_robot_description)/meshes/back_left_wheel.STL'/>
            </geometry>
        </collision>

        <inertial>
            <mass value = '0.0515309299357028'/>
            <inertia ixx = '${a*1.45942986129926E-05}' 
                     ixy = '${a*-3.19787215398093E-10}' 
                     ixz = '${a*1.74943062058915E-09}'
                     iyy = '${a*1.45948727598913E-05}' 
                     iyz = '${a*1.61769812110049E-10}'
                     izz = '${a*2.4263683888153E-05}'/>
        </inertial>
    </link>

    <!-- back left wheel to chassis joint -->
    <joint name = 'back_left_joint' type = 'continuous'>
        <origin xyz = '-0.08 0.084492 -0.03954' rpy = '1.5703 0 0'/>
        <parent link = 'chassis_link'/>
        <child link = 'back_left_wheel_link'/>
        <axis xyz = '0 0 -1' rpy = '0 0 0'/>
        <dynamics damping = '${d}'/>
    </joint>
</robot>